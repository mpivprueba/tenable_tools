# Policies Module

The policies/ module manages scan policies in Tenable.io.
It provides functions to create, list, update, and delete scan policies, making it easier to standardize vulnerability scans across your organization.

---

## Files in this module

- `create_policy.py` → Creates a new scan policy.
- `list_templates.py` → Creates a new scan policy.  

---

## Requirements

This module depends on the following Python libraries (already included in `requirements.txt`):

requests
python-dotenv

---

## Install them with:

pip install -r requirements.txt

### Environment variables

The module requires API credentials and configuration stored in a .env file at the project root:

ACCESS_KEY=your_access_key
SECRET_KEY=your_secret_key
BASE_URL=https://cloud.tenable.com

Usage guide

Below are step-by-step instructions for each function, including the code to add in main.py and the terminal commands.

### 1. Create Policy
File: create_policy.py

from policies.create_policy import create_policy

if __name__ == "__main__":
    policy_id = create_policy(
        name="Standard Network Policy",
        description="Policy for regular weekly scans",
        settings={"port_scan": "all", "credentials": []}
    )
    print(f"Policy created with ID: {policy_id}")

* Input: 

name (str): Policy name

description (str): Short description of the policy

settings (dict): Scan configuration (e.g., port scan type, credentials, plugins)

* Output: policy_id (unique identifier of the created policy)

### 2. List Policies
File: list_policies.py

from policies.list_policies import list_policies

if __name__ == "__main__":
    policies = list_policies()
    print("Available policies:")
    for policy in policies:
        print(f"ID: {policy['id']}, Name: {policy['name']}")

* Input: None.
* Output: List of policies (id, name, description).

---

## Example workflow

1. Create a new policy:

policy_id = create_policy("Quick Scan Policy", "Optimized for fast scans", {"port_scan": "fast"})

2. List all policies:

list_policies()

---

## Notes
* Policies allow consistent scan configurations across different teams.

* Updating a policy immediately affects all new scans created from it.

* Deleted policies cannot be restored; double-check the policy ID before deletion.