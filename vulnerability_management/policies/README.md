# Policies Module

The Policies module provides comprehensive scan policy management for [Tenable.io](https://www.tenable.com/products/vulnerability-management), enabling security teams to create, configure, and manage scan policies that define how vulnerability assessments are conducted.

---

## Purpose

This module provides centralized policy management capabilities for Tenable.io, allowing security teams to:

* Create and configure scan policies based on standardized templates

* Define scanning parameters and target specifications

* Integrate credentials for authenticated scanning

* Establish consistent scanning methodologies across the organization

* Streamline policy deployment and management

---
## Module Structure

```
policies/
├── create_policy.py          # Create new scan policies
├── list_templates.py         # List available scan templates
└── README.md                 # This documentation file
```

---

## Files in this module

**create_policy.py** → Create new scan policies in Tenable.io using template UUIDs with target and credential configuration.
**list_templates.py** → Display all available scan templates with their names and UUIDs for policy creation.

---

## Requirements

This module depends on the following Python libraries (already included in `requirements.txt`):

requests
python-dotenv

---

## Install them with:

pip install -r requirements.txt

### Environment variables

The module requires API credentials and configuration stored in a .env file at the project root:

ACCESS_KEY=your_access_key

SECRET_KEY=your_secret_key

BASE_URL=https://cloud.tenable.com

---

## Core Functionalities

### 1. Policy Creation and Configuration

**File: create_policy.py**
```
The create_policy.py module enables creation of comprehensive scan policies with target and credential integration:

def create_policy(name, template_uuid, targets="", credentials_uuid=None):
    """
    Creates a new scan policy in Tenable.io with comprehensive configuration:
    - Policy naming and description
    - Target specification (IPs/hostnames)
    - Credential integration for authenticated scanning
    - Scanner assignment and launch settings
    - Template-based policy structure
    """
```

### 2. Template Discovery and Selection

**File: list_templates.py**
```
The list_templates.py module provides discovery of all available scan templates:

def list_templates():
    """
    Retrieves and displays all available scan templates including:
    - Template names and descriptions
    - Template UUIDs for policy creation
    - Template categorization and use cases
    - Compatibility information for credential integration
    """
```
---

# Getting Started

### Step-by-Step: Opening Terminal and Navigating to Your Project

Step 1: Open Command Prompt or PowerShell

* Press Windows + R keys simultaneously

* Type cmd for Command Prompt or powershell for PowerShell

* Press Enter

### Step 2: Navigate to Your Project Directory

You need to navigate to the folder where you downloaded or cloned the Tenable Tools project. Replace the example path with your actual project location:

cd "C:\PATH\TO\YOUR\PROJECT\tenable_tools\vulnerability_management"

Examples of actual paths:

#### If you saved it in Documents:
cd "C:\Users\YourUsername\Documents\tenable_tools\vulnerability_management"

#### If you saved it on Desktop:
cd "C:\Users\YourUsername\Desktop\tenable_tools\vulnerability_management"

#### If you saved it in a different drive:
cd "D:\Projects\tenable_tools\vulnerability_management"


### Step 3: Verify Your Location
After running the cd command, your terminal should show something like:

PS C:\Users\YourUsername\Documents\tenable_tools\vulnerability_management>


### Step 4: Activate Virtual Environment (if created)

..\venv\Scripts\activate


### Step 5: Verify You Can Run Commands

python main.py --help

---
---
## How to Find Your Correct Project Path

* Open File Explorer and navigate to your project folder

* Click on the address bar at the top of the window

* Copy the full path shown in the address bar

* Use that exact path in the cd command in your terminal

#### Example:

If your address bar shows:
C:\Development\security_tools\tenable_tools\vulnerability_management

Then use:
cd "C:\Development\security_tools\tenable_tools\vulnerability_management"

---

## Runtime Dependencies

Main CLI Interface [main.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/main.py) - Required for terminal execution

API Utilities [api_utils.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/api_utils.py) - Provides authentication headers

Configuration [config.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/config.py) - Contains base URL and API settings

---

## Quick Usage Examples

1. List Available Scan Templates

Command to run:

```
python main.py list_templates
```

Expected Output:

```
Available scan templates:

- Advanced Scan | UUID: 731a8e52-3ea6-4c0a-8c4a-5b17b61d7f8c
- Basic Network Scan | UUID: 708a8e52-3ea6-4c0a-8c4a-5b17b61d7f8c
- Web Application Tests | UUID: 728a8e52-3ea6-4c0a-8c4a-5b17b61d7f8c
- Discovery Scan | UUID: 724a8e52-3ea6-4c0a-8c4a-5b17b61d7f8c
```
### Understanding the command:

* Template Name: Human-readable template identifier
* UUID: Unique identifier used for policy creation
* Template Types: Different scanning methodologies (Discovery, Advanced, Web App, etc.)

2. Create Basic Network Scan Policy

Command to run:

```
python main.py create_policy "Internal Network Scan" "724a8e52-3ea6-4c0a-8c4a-5b17b61d7f8c" "192.168.1.0/24"
```

Expected Output:

```
Policy created successfully. UUID: 12345678-1234-1234-1234-123456789abc
```
### Understanding the command:

* Policy Name: "Internal Network Scan" - Descriptive policy identifier
* Template UUID: "724a8e52-3ea6-4c0a-8c4a-5b17b61d7f8c" - Discovery scan template
* Targets: "192.168.1.0/24" - IP range to scan

---

## Notes
* Template-Based: All policies are created from standardized Tenable.io templates

* Target Flexibility: Supports multiple target specification formats

* Credential Integration: Optional credential attachment for authenticated scanning

* Scanner Assignment: Automatically assigns to default Tenable.io scanner

* On-Demand Execution: Policies are configured for manual (on-demand) execution

* Error Handling: Comprehensive API error handling and permission verification