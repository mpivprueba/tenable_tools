# Vulnerabilities Module

The Vulnerabilities module provides comprehensive vulnerability analysis and reporting capabilities for [Tenable.io](https://www.tenable.com/products/vulnerability-management), enabling security teams to identify, analyze, and report on security vulnerabilities across their infrastructure.

---

## Purpose

This module provides advanced vulnerability management capabilities for [Tenable.io](https://www.tenable.com/products/vulnerability-management), allowing security teams to:

* Export and analyze vulnerability scan results in multiple formats

* Identify and count critical vulnerabilities for risk assessment

* Generate comprehensive vulnerability reports with severity analysis

* Categorize and tag vulnerabilities for better organization

* Read and process scan results for further analysis

* Track vulnerability trends and remediation progress

---

## Module Structure

```
vulnerabilities/
├── __init__.py
├── critical_vuln_count.py                # Count critical vulnerabilities
├── tags.py                               # Asset tagging analysis
├── vulnerabilities_export_csv.py         # Export vulnerabilities to CSV
├── vulnerabilities_read_scan_results.py  # Read and display scan results
├──  vulnerabilities_reports.py            # Generate comprehensive vulnerability reports
└── README.md                             # This documentation file
```

---

# Files in this module

**critical_vuln_count.py** → Counts and identifies critical severity vulnerabilities from scan results.

**tags.py** → Analyzes asset tagging and generates tag summaries for categorization.

**vulnerabilities_export_csv.py** →  Exports vulnerability data to CSV format for external analysis.

**vulnerabilities_read_scan_results.py** → Reads and displays scan results in readable format.

**vulnerabilities_reports.py** →  Generates comprehensive vulnerability reports with detailed analysis.


---

## Requirements

This module depends on the following Python libraries (already included in requirements.txt):

requests
python-dotenv

---

## Install them with:

pip install -r requirements.txt

### Environment variables

The module requires API credentials and configuration stored in a .env file at the project root:

ACCESS_KEY=your_access_key

SECRET_KEY=your_secret_key

BASE_URL=https://cloud.tenable.com

---

## Core Functionalities

### 1. Critical Vulnerability Analysis

**File: critical_vuln_count.py**

The [critical_vuln_count.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/vulnerabilities/critical_vuln_count.py) module identifies and counts high-risk vulnerabilities:

```
def count_critical_vulnerabilities():
    """
    Analyzes scan results to identify and count critical vulnerabilities:
    - Scans CSV files for severity and risk indicators
    - Identifies vulnerabilities marked as critical (severity 4)
    - Provides risk-based vulnerability prioritization
    - Supports multiple severity classification systems
    """
```

### 2. Asset Tagging and Categorization

**File: list_scans.py**

The [tags.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/vulnerabilities/tags.py) module provides asset tagging analysis and organization:

```
class tags:
    def summary(self):
        """
        Analyzes asset tagging patterns and generates comprehensive reports:
        - Extracts and categorizes asset tags from Tenable.io
        - Identifies untagged assets requiring categorization
        - Generates tag frequency analysis and distribution
        - Creates exportable reports for compliance and organization
        """
```

### 3. Vulnerability Data Export

**File: vulnerabilities_export_csv.py**

The [vulnerabilities_export_csv.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/vulnerabilities/vulnerabilities_export_csv.py) module handles vulnerability data export:

```
def export_vulnerability_report(scan_id=None):
    """
    Exports vulnerability data to CSV format with comprehensive information:
    - Supports specific scan IDs or automatic completed scan selection
    - Includes detailed vulnerability attributes and metadata
    - Handles export queuing and download processes
    - Provides error handling for export failures
    """
```

### 4. Scan Results Processing

**File: vulnerabilities_read_scan_results.py**

The [vulnerabilities_read_scan_results.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/vulnerabilities/vulnerabilities_read_scan_results.py) module processes and displays scan results:

```
def read_scan_results(path="myscan.csv", row_limit=10):
    """
    Reads and displays vulnerability scan results in readable format:
    - Parses CSV scan results with proper encoding handling
    - Displays formatted vulnerability data for quick review
    - Supports customizable row limits for large datasets
    - Provides error handling for file access issues
    """
```

### 5. Comprehensive Vulnerability Reporting

**File: vulnerabilities_reports.py**

The [vulnerabilities_reports.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/vulnerabilities/vulnerabilities_reports.py) module generates detailed vulnerability reports:

```
class vulnerabilities:
    def report(self, *scan_ids):
        """
    Generates comprehensive vulnerability reports across multiple scans:
    - Aggregates vulnerability data from specified scan IDs
    - Categorizes vulnerabilities by severity and type
    - Provides detailed descriptions and risk analysis
    - Supports single scan or multi-scan reporting
    """
```
---

# Getting Started

### Step-by-Step: Opening Terminal and Navigating to Your Project

Step 1: Open Command Prompt or PowerShell

* Press Windows + R keys simultaneously

* Type cmd for Command Prompt or powershell for PowerShell

* Press Enter

### Step 2: Navigate to Your Project Directory

You need to navigate to the folder where you downloaded or cloned the Tenable Tools project. Replace the example path with your actual project location:

cd "C:\PATH\TO\YOUR\PROJECT\tenable_tools\vulnerability_management"

Examples of actual paths:

#### If you saved it in Documents:
cd "C:\Users\YourUsername\Documents\tenable_tools\vulnerability_management"

#### If you saved it on Desktop:
cd "C:\Users\YourUsername\Desktop\tenable_tools\vulnerability_management"

#### If you saved it in a different drive:
cd "D:\Projects\tenable_tools\vulnerability_management"


### Step 3: Verify Your Location
After running the cd command, your terminal should show something like:

PS C:\Users\YourUsername\Documents\tenable_tools\vulnerability_management>


### Step 4: Activate Virtual Environment (if created)

..\venv\Scripts\activate


### Step 5: Verify You Can Run Commands

python main.py --help

---
## How to Find Your Correct Project Path

* Open File Explorer and navigate to your project folder

* Click on the address bar at the top of the window

* Copy the full path shown in the address bar

* Use that exact path in the cd command in your terminal

#### Example:

If your address bar shows:
C:\Development\security_tools\tenable_tools\vulnerability_management

Then use:
cd "C:\Development\security_tools\tenable_tools\vulnerability_management"

---

## Runtime Dependencies

Main CLI Interface [main.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/main.py) - Required for terminal execution

API Utilities [api_utils.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/api_utils.py) - Provides authentication headers

Configuration [config.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/config.py) - Contains base URL and API settings

[Scans Module](https://github.com/mpivprueba/tenable_tools/tree/main/vulnerability_management/scans) - For accessing scan results and vulnerability data

---

## Quick Usage Examples

### 1. Count Critical Vulnerabilities

Command to run:

```
python main.py critical_vulns_count
```

Expected Output:

```
Total critical vulnerabilities found: 15
```

### Understanding the command:

* Count: Number of vulnerabilities identified as critical severity
* Source: Reads from myscan.csv file generated by previous scans
* Severity: Identifies vulnerabilities with "Critical" risk or severity level 4

### 2. Generate Tag Summary

Command to run:

```
python main.py generate_tags_summary
```

Expected Output:

```
Number of assets received: 45
Tag summary exported to 'tag_summary.csv'
Untagged assets exported to 'untagged_assets.csv'

Console summary:
production: 25
development: 12
web-server: 8
database: 5

```

### 3. Export Vulnerability Report

Command to run:

```
python main.py generate_vulns_report 1001 1002 1003
```

Expected Output:

```
Vulnerabilities report exported.
```

Generated File: vulnerabilities_report.csv

```
Scan ID,Name,Severity,Description
1001,SSL Medium Strength Cipher Suites Supported,Medium,The remote service supports...
1001,SSH Server CBC Mode Ciphers Enabled,Medium,The SSH server is configured...
1002,Apache HTTP Server Version Disclosure,Low,The remote web server discloses...
```

### 4. Export Specific Scan to CSV

Command to run:

```
python main.py export 1001
```
Expected Output:

```
>> Exporting vulnerability scan ID: 1001
vulnerability_scan.csv exported successfully.
```

### 5. Read Scan Results

Command to run:

```
python main.py read_results
```

Expected Output:

```
Plugin ID | Severity | Plugin Name | Host | Protocol | Port
--------------------------------------------------------------------------------
19506 | Critical | SSH Server CBC Mode Ciphers Enabled | 192.168.1.10 | tcp | 22
10107 | High | SSL Certificate Cannot Be Trusted | 192.168.1.20 | tcp | 443

```

### 6.  Complete Vulnerability Analysis Workflow

Step 1: Export Recent Scan Data

```
python main.py export 1001
```
--- 

Step 2: Count Critical Vulnerabilities

```
python main.py critical_vulns_count
```
--- 

Step 3: Generate Comprehensive Report

```
python main.py generate_vulns_report 1001
```
---
Step 4: Review Results

```
python main.py read_results
```
---
Step 5: Analyze Asset Tagging

```
python main.py generate_tags_summary
```
---

## Notes

* **Multiple Export Formats:** Supports CSV for further analysis in external tools

* **Severity-Based Filtering:** Focuses on critical vulnerabilities for risk prioritization

* **Asset Correlation:** Links vulnerabilities to specific assets and their characteristics

* **Comprehensive Reporting:** Generates reports suitable for different audiences (technical, management, compliance)

* **Error Handling:** Robust error handling for API connectivity and data processing issues

* **Performance Optimization:** Efficient processing of large vulnerability datasets