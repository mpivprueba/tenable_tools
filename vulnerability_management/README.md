# Vulnerability Management 

The Vulnerability Management module is the core component of Tenable Tools, providing comprehensive capabilities for centralized vulnerability management, automated reporting, and security risk assessment.

This README serves as a step-by-step guide for clients to set up, configure,
and use the CLI effectively.

---

## Core Capabilities

* Centralized Vulnerability Management: Aggregation and correlation of vulnerability data from multiple scans.

* Unified Security Findings: Consolidation of security discoveries into a single view.

* Historical Tracking: Temporal monitoring of security posture evolution.

* Export and Reporting: CSV export of complete vulnerability data for external analysis.

* Severity Analysis and Prioritization: Automatic detection of critical and high-severity vulnerabilities.

* All functionality is accessible via the [main.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/main.py) CLI script.

--- 

## Module Architecture

vulnerability_management/
├── assets/           # Asset management and categorization
├── credentials/      # Secure credential storage
├── policies/         # Scan policy configuration
├── scans/            # Scan scheduling and execution
├── tests/            # Unit and integration testing
├── vulnerabilities/  # Vulnerability analysis and reporting
└── webapp/           # Main web interface for the module

---

## Workflow Description

###  Module Relationships
The modules interact in a security value chain where output from one becomes input to the next:

Credentials → Policies → Scans → Vulnerabilities → Assets
     ↓
   WebApp (Interface/Orchestration)

### Detailed Workflow Relationships

1. Credentials → Policies

Relationship: Fundamental input for effective policies

Purpose: Policies use credentials for authenticated, privileged scans

Example: Policies reference credential UUIDs for domain authentication


2. Policies → Scans

Relationship: Configuration template for execution

Purpose: Policies define "what" and "how" to scan, scans execute the definition

Example: Scan instances reference policy UUIDs for configuration


3. Scans → Vulnerabilities

Relationship: Data source for security analysis

Purpose: Transforms raw scan data into actionable security information

Example: Vulnerability analysis processes scan results and calculates risk scores


4. Scans → Assets

Relationship: Discovery and inventory enrichment

Purpose: Scans discover assets, assets categorize and manage them

Example: Asset inventory updates with discovered hosts and scan timestamps


5. Vulnerabilities → Assets

Relationship: Risk context for specific assets

Purpose: Enriches asset inventory with security context

Example: Assets display vulnerability counts and risk levels

# Installation

## Step 1: Prerequisites

Before starting, ensure you have:

- **Python 3.10 or higher** installed
- **pip** (Python package manager)
- An **active Tenable.io account** with API access
- Internet connection

1. Clone the repository:

## Step 2: Clone the Repository

Open a terminal or command prompt and run:

bash
git clone <repository_url>
cd tenable_tools

## Step 3: Create a Virtual Environment (Optional but Recommended)

python -m venv venv

* Activate the environment:

Windows:
venv\Scripts\activate

Linux / macOS:
source venv/bin/activate

## Step 4: Install Required Python Libraries
All dependencies are listed in requirements.txt. Install them with:

pip install -r requirements.txt

Dependencies included:

-requests – For making HTTP requests to Tenable.io API
-python-dotenv – For reading .env configuration files
-tabulate – Optional, for nicely formatted table outputs
-smtplib (built-in Python library) – For sending email notifications
-email (built-in Python library) – For composing email messages
-Any other libraries included in requirements.txt

Verify installation by running:

pip list

You should see all required packages installed.

## Step 5: Configure Environment Variables

Create a .env file in the project root with the following content:

# Tenable.io API credentials
ACCESS_KEY=<your_access_key>
SECRET_KEY=<your_secret_key>
BASE_URL=https://cloud.tenable.com

# Email configuration for alerts and notifications
EMAIL_FROM=<sender_email_address>
EMAIL_TO=<recipient_email_address>
EMAIL_SERVER=<smtp_server>
EMAIL_PORT=<smtp_port>
EMAIL_USER=<smtp_user>
EMAIL_PASS=<smtp_password>

Explanation of variables:

ACCESS_KEY / SECRET_KEY: API credentials from Tenable.io
BASE_URL: Base URL for Tenable.io API (default: https://cloud.tenable.com)
EMAIL_FROM: Sender email for notifications
EMAIL_TO: Recipient email for alerts
EMAIL_SERVER: SMTP server (e.g., smtp.office365.com)
EMAIL_PORT: SMTP port (e.g., 587 for TLS)
EMAIL_USER: Email username
EMAIL_PASS: Email password or app-specific password

## Step 6: Run the CLI

Test the setup by running the CLI:

python main.py

This will display a list of all available commands and usage instructions.

Example commands:

python main.py scans
python main.py generate_assets_report
python main.py critical_vulns <scan_id>


## Step 7: Next Steps

Once the environment is ready:

*Explore module-specific commands:
    -scans/ – Manage and schedule scans 
    -assets/ – Export assets, generate reports, and view tags
    -credentials/ – Create, edit, delete, and list credentials
    -policies/ – Create and list scan policies
    -vulnerabilities/ – Export vulnerabilities and generate reports
    -webapp/ – Launch Web Application Scans (WAS)

Each module will have its own detailed README with examples and explanations.