# Scans Module

The Scans module provides comprehensive scan management capabilities for [Tenable.io](https://www.tenable.com/products/vulnerability-management), enabling security teams to create, launch, schedule, and manage vulnerability scans across their infrastructure.

---

## Purpose

This module provides complete scan lifecycle management for [Tenable.io](https://www.tenable.com/products/vulnerability-management), allowing security teams to:

* Create and configure new vulnerability scans

* Launch immediate or scheduled scan executions

* Monitor scan status and progress

* Export scan results in multiple formats

* Manage scanner resources and assignments

* Coordinate scan operations across the organization

---

## Module Structure

```
scans/
├── __init__.py
├── create_scan.py           # Interactive scan creation
├── list_scans.py            # Display all available scans
├── list_scanners.py         # List available scanners
├── scans_schedule.py        # Schedule and launch scans
├──results_export_pdf.py     # Export scan results to PDF
└── README.md                # This documentation file
```

---

# Files in this module

**create_scan.py** → Interactive creation of new vulnerability scans with comprehensive configuration.

**list_scans.py** → Display all available scans with status information and sorting.

**list_scanners.py** →  List all registered scanners with availability and status.

**scans_schedule.py** → Schedule recurring scans and launch immediate scan executions.

**results_export_pdf.py** → Export scan results to PDF format for reporting and compliance.


---

## Requirements

This module depends on the following Python libraries (already included in requirements.txt):

requests
python-dotenv

---

## Install them with:

pip install -r requirements.txt

### Environment variables

The module requires API credentials and configuration stored in a .env file at the project root:

ACCESS_KEY=your_access_key

SECRET_KEY=your_secret_key

BASE_URL=https://cloud.tenable.com

---

## Core Functionalities

### 1. Interactive Scan Creation

**File: create_scan.py**

The [create_scan.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/scans/create_scan.py) module provides interactive scan creation with comprehensive configuration:

```
def create_scan_interactive():
    """
    Interactively creates new vulnerability scans with user input for:
    - Scan naming and description
    - Template selection and configuration
    - Target specification and scope definition
    - Credential integration for authenticated scanning
    - Scanner assignment and resource allocation
    """
```

### 2. Scan Inventory Management

**File: list_scans.py**

The [list_scans.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/scans/list_scans.py) module displays and organizes all available scans:

```
def list_scans():
    """
    Retrieves and displays comprehensive scan information including:
    - Scan IDs and names for reference
    - Current status (running, completed, paused, etc.)
    - Scan configuration and target scope
    - Historical execution data and results
    """
```

### 3. Scanner Resource Management

**File: list_scanners.py**

The [list_scanners.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/scans/list_scanners.py) module manages scanner resources and availability:

```
def list_scanners():
    """
    Displays all available scanning resources including:
    - Scanner names and identification
    - Availability status and capacity
    - Geographic and network location
    - Performance characteristics and capabilities
    """
```

### 4. Scan Scheduling and Execution

**File: scans_schedule.py**

The [scans_schedule.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/scans/scans_schedule.py) module handles scan scheduling and immediate execution:

```
def schedule_scan(scan_id, rrule="FREQ=DAILY;INTERVAL=1"):
    """
    Schedules recurring scans with flexible scheduling options:
    - Custom recurrence rules (daily, weekly, monthly)
    - Time-based scheduling and calendar integration
    - Resource optimization and conflict avoidance
    - Status verification and error handling
    """

def launch_scan(scan_id):
    """
    Launches immediate scan executions with:
    - Real-time status monitoring
    - Resource allocation and management
    - Progress tracking and notification
    - Error handling and recovery
    """
```

### 5. Results Export and Reporting

**File: results_export_pdf.py**

The [results_export_pdf.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/scans/results_export_pdf.py) module provides comprehensive reporting capabilities:

```
def export_scan_to_pdf(scan_id):
    """
    Exports scan results to professional PDF reports including:
    - Executive summaries and risk overview
    - Detailed vulnerability findings
    - Asset-based risk analysis
    - Compliance and remediation tracking
    """
```
---

# Getting Started

### Step-by-Step: Opening Terminal and Navigating to Your Project

Step 1: Open Command Prompt or PowerShell

* Press Windows + R keys simultaneously

* Type cmd for Command Prompt or powershell for PowerShell

* Press Enter

### Step 2: Navigate to Your Project Directory

You need to navigate to the folder where you downloaded or cloned the Tenable Tools project. Replace the example path with your actual project location:

cd "C:\PATH\TO\YOUR\PROJECT\tenable_tools\vulnerability_management"

Examples of actual paths:

#### If you saved it in Documents:
cd "C:\Users\YourUsername\Documents\tenable_tools\vulnerability_management"

#### If you saved it on Desktop:
cd "C:\Users\YourUsername\Desktop\tenable_tools\vulnerability_management"

#### If you saved it in a different drive:
cd "D:\Projects\tenable_tools\vulnerability_management"


### Step 3: Verify Your Location
After running the cd command, your terminal should show something like:

PS C:\Users\YourUsername\Documents\tenable_tools\vulnerability_management>


### Step 4: Activate Virtual Environment (if created)

..\venv\Scripts\activate


### Step 5: Verify You Can Run Commands

python main.py --help

---
## How to Find Your Correct Project Path

* Open File Explorer and navigate to your project folder

* Click on the address bar at the top of the window

* Copy the full path shown in the address bar

* Use that exact path in the cd command in your terminal

#### Example:

If your address bar shows:
C:\Development\security_tools\tenable_tools\vulnerability_management

Then use:
cd "C:\Development\security_tools\tenable_tools\vulnerability_management"

---

## Runtime Dependencies

Main CLI Interface [main.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/main.py) - Required for terminal execution

API Utilities [api_utils.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/api_utils.py) - Provides authentication headers

Configuration [config.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/config.py) - Contains base URL and API settings

[Policies Module](https://github.com/mpivprueba/tenable_tools/tree/main/vulnerability_management/policies) - For scan policy configuration and templates

[Credentials Module](https://github.com/mpivprueba/tenable_tools/tree/main/vulnerability_management/credentials) - For authenticated scanning capabilities

---

## Quick Usage Examples

### 1. List All Available Scans

Command to run:

```
python main.py scans
```

Expected Output:

```
Available scans (sorted by ID):
- ID: 1001 | Name: Weekly Network Audit | Status: completed
- ID: 1002 | Name: Web Application Test | Status: running
- ID: 1003 | Name: Database Server Scan | Status: pending
- ID: 1004 | Name: Emergency Security Check | Status: canceled
```

### Understanding the command:

* Scan ID: Unique identifier for scan operations
* Scan Name: Descriptive name for scan identification
* Status: Current state (completed, running, pending, canceled)

### 2. List Available Scanners

Command to run:

```
python main.py list_scanners
```

Expected Output:

```
Available scanners:

- US-East Scanner | ID: 641464 | Status: on
- EU-Central Scanner | ID: 641465 | Status: on
- AP-South Scanner | ID: 641466 | Status: off
- Cloud Scanner | ID: 641467 | Status: on
```

### Understanding the command:

* Scanner Name: Geographic or functional identifier
* Scanner ID: Unique identifier for scanner assignment
* Status: Availability status (on/off)

### 3. Create New Scan Interactively

Command to run:

```
python main.py create_scan
```

Expected Output:

```
=== Create New Scan ===
Scan name: Quarterly Security Assessment
Template UUID: 731a8e52-3ea6-4c0a-8c4a-5b17b61d7f8c
Targets (comma-separated IPs or domains): 192.168.1.0/24,192.168.2.0/24
Credential UUID (leave blank if none): 87654321-4321-4321-4321-210987654321
Scanner ID (e.g. 641464): 641464

Scan created successfully. ID: 1005
```

### 4. Schedule a Recurring Scan

Command to run:

```
python main.py schedule 1005 FREQ=WEEKLY;INTERVAL=2
```
Expected Output:

```
Scan 1005 scheduled successfully.
```

### 5. Launch Scan Immediately

Command to run:

```
python main.py schedule 1005 FREQ=WEEKLY;INTERVAL=2
```

Expected Output:

```
Scan 1005 scheduled successfully.
```

### 6. Export Scan Results to PDF

Command to run:

```
python main.py export_pdf 1001
```

Expected Output:

```
PDF report saved as scan_1001.pdf
```

### 7.  Complete Scan Workflow

Step 1: Check Available Scanners

```
python main.py list_scanners
```
--- 

Step 2: List Existing Scans

```
python main.py scans
```
--- 

Step 3: Create New Scan

```
python main.py create_scan
```
---
Step 4: Launch Scan Execution

```
python main.py schedule 1005
```
---
Step 5: Export Results

```
python main.py export_pdf 1005
```
---
# Scan Configuration Details
## Target Specification Formats

* IP Ranges: 192.168.1.1-192.168.1.100

* CIDR Notation: 192.168.1.0/24

* Multiple Networks: 192.168.1.0/24,10.0.1.0/24

* Hostnames: server1.company.com,server2.company.com

* Mixed Targets: 192.168.1.0/24,server1.company.com

---
# Scan Status Definitions

* **pending:** Scan is queued for execution

* **running:** Scan is currently in progress

* **completed:** Scan has finished successfully

* **paused:** Scan has been temporarily stopped

* **canceled:** Scan was canceled before completion

* **error:** Scan encountered an error during execution

---

## Notes

* **Interactive Creation:** Scan creation guides users through all required parameters.

* **Flexible Scheduling:** Supports both immediate execution and recurring schedules.

* **Resource Management:** Automatically handles scanner assignment and availability.

* **Comprehensive Reporting:** PDF exports include detailed vulnerability analysis.

* **Error Handling:** Robust error handling for network issues and API limitations.

* **Status Tracking:** Real-time status monitoring and progress reporting.