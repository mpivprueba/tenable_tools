# Credentials Module

The Credentials module functions as the centralized authentication credentials manager for security scans, enabling secure storage, management, and utilization of credentials for authenticated scanning in [Tenable.io](https://www.tenable.com/products/vulnerability-management).

---

## Purpose

This module provides comprehensive credential management capabilities for Tenable.io, allowing security teams to:

* Securely store and manage authentication credentials for various systems

* Enable authenticated scanning for deeper vulnerability assessment

* Support privilege escalation for comprehensive security evaluation

* Maintain credential lifecycle management (create, read, update, delete)

---

## Module Structure

```
credentials/
├── __init__.py
├── create_credentials.py          # Create new credentials
├── edit_credentials.py            # Modify existing credentials  
├── delete_credentials.py          # Delete credentials
├── list_credentials.py            # List all credentials
├── list_credential_types.py       # Query credential types
├── list_credential_names.py       # Credential type names
├── extract_credential_ids.py      # Unique credential type IDs
├── show_type_config.py            # Type-specific configuration
└── README.md                      # This documentation file
```

---

# Files in this module

**create_credentials.py** → Create new SSH credentials in Tenable.io with privilege escalation suppor.

**edit_credentials.py** → Modify existing credentials partially or completely.

**delete_credentials.py** → Permanently delete credentials from Tenable.io.

**list_credentials.py** → Display all registered credentials in the system.

**list_credential_types.py** → Display complete structure of available credential types.

**list_credential_names.py** → Provide readable names of all supported credential types.

**extract_credential_ids.py** → Extract and display unique IDs of all available credential types.

**show_type_config.py** → Display expected configuration for specific credential type.

---

## Requirements

This module depends on the following Python libraries (already included in requirements.txt):

requests
python-dotenv

---

## Install them with:

pip install -r requirements.txt

### Environment variables

The module requires API credentials and configuration stored in a .env file at the project root:

ACCESS_KEY=your_access_key

SECRET_KEY=your_secret_key

BASE_URL=https://cloud.tenable.com

---

## Core Functionalities

### 1. Credential Creation and Management

**File: create_credentials.py**

The [create_credentials.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/credentials/create_credentials.py) module provides secure credential creation with privilege escalation support:

```
def create_credential(name, username, password, escalation_method, escalation_account, escalation_password, bin_directory):
    """
    Creates new SSH credentials in Tenable.io with comprehensive privilege escalation options
    Supports multiple escalation methods: sudo, su, su+sudo, dzdo, pbrun
    Securely transmits credentials via HTTPS to Tenable.io cloud storage
    """
```

### 2. Credential Modification

**File: edit_credentials.py**

The [edit_credentials.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/credentials/edit_credentials.py) module enables partial or complete credential updates:

```
def edit_credential(uuid, name, username, password, escalation_method, escalation_account, escalation_password, bin_directory):
    """
    Modifies existing credentials while maintaining UUID integrity
    Supports selective updates - only changed fields need to be provided
    Maintains credential relationships with existing scans and policies
    """
```

### 3. Credential Deletion

**File: delete_credentials.py**

The [delete_credentials.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/credentials/delete_credentials.py) module handles secure credential removal:

```
def delete_credential(uuid):
    """
    Permanently removes credentials from Tenable.io
    Provides operation confirmation and error handling
    Ensures clean removal from the credential inventory
    """
```

### 4. Credential Inventory Management

**File:  list_credentials.py**

The [list_credentials.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/credentials/list_credentials.py) module displays all registered credentials:

```
def list_credentials():
    """
    Retrieves and displays comprehensive credential information including:
    - Credential name and UUID
    - Credential type and associated user
    - Privilege escalation method
    - Integration status with scans and policies
    """
```

### 5. Credential Type Discovery

**File: list_credential_types.py**

The [list_credential_types.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/credentials/list_credential_types.py) module provides complete credential type structure:

```
def list_credential_types():
    """
    Displays complete hierarchical structure of available credential types
    Shows detailed category information and type specifications
    Essential for development and integration planning
    """
```

### 6. Credential Type Names

**File: list_credential_names.py**

The [list_credential_names.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/credentials/list_credential_names.py) module provides human-readable type names:

```
def list_credential_names():
    """
    Returns readable names of all supported credential types
    Facilitates user-friendly credential type selection
    Supports internationalization and localization needs
    """
```

### 7. Credential Type ID Extraction

**File: extract_credential_ids.py**

The [extract_credential_ids.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/credentials/extract_credential_ids.py) module extracts unique credential type identifiers:

```
def extract_credential_ids():
    """
    Extracts and displays unique IDs for all available credential types
    Provides mapping between type IDs and visible names
    Essential for API integration and automation scripts
    """
```

### 8. Credential Configuration Templates

**File: show_type_config.py**

The [show_type_config.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/credentials/show_type_config.py) module displays type-specific configuration requirements:

```
def show_type_config(type_id):
    """
    Shows expected configuration structure for specific credential types including:
    - Required and optional fields
    - Valid values for enumeration fields
    - Field descriptions and usage examples
    - Privilege escalation options and dependencies
    """
```
---

# Getting Started

### Step-by-Step: Opening Terminal and Navigating to Your Project

Step 1: Open Command Prompt or PowerShell

* Press Windows + R keys simultaneously

* Type cmd for Command Prompt or powershell for PowerShell

* Press Enter

### Step 2: Navigate to Your Project Directory

You need to navigate to the folder where you downloaded or cloned the Tenable Tools project. Replace the example path with your actual project location:

cd "C:\PATH\TO\YOUR\PROJECT\tenable_tools\vulnerability_management"

Examples of actual paths:

#### If you saved it in Documents:
cd "C:\Users\YourUsername\Documents\tenable_tools\vulnerability_management"

#### If you saved it on Desktop:
cd "C:\Users\YourUsername\Desktop\tenable_tools\vulnerability_management"

#### If you saved it in a different drive:
cd "D:\Projects\tenable_tools\vulnerability_management"


### Step 3: Verify Your Location
After running the cd command, your terminal should show something like:

PS C:\Users\YourUsername\Documents\tenable_tools\vulnerability_management>


### Step 4: Activate Virtual Environment (if created)

..\venv\Scripts\activate


### Step 5: Verify You Can Run Commands

python main.py --help

---
## How to Find Your Correct Project Path

* Open File Explorer and navigate to your project folder

* Click on the address bar at the top of the window

* Copy the full path shown in the address bar

* Use that exact path in the cd command in your terminal

#### Example:

If your address bar shows:
C:\Development\security_tools\tenable_tools\vulnerability_management

Then use:
cd "C:\Development\security_tools\tenable_tools\vulnerability_management"

---

## Runtime Dependencies

Main CLI Interface [main.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/main.py) - Required for terminal execution

API Utilities [api_utils.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/api_utils.py) - Provides authentication headers

Configuration [config.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/config.py) - Contains base URL and API settings

---

## Quick Usage Examples

### 1. Create Basic SSH Credential

Command to run:

```
python main.py create_credential "Linux-Servers-Basic" "scanuser" "MySecurePass123!" "Nothing"
```

Expected Output:

```
Credential created successfully. ID: 12345678-1234-1234-1234-123456789abc
```

### Understanding the command:

* Credential Name: "Linux-Servers-Basic" - Descriptive identifier
* Username: "scanuser" - SSH username for authentication
* Password: "MySecurePass123!" - Authentication password
* Escalation Method: "Nothing" - No privilege escalation

### 2. Create SSH Credential with Sudo Escalation

Command to run:

```
python main.py create_credential "Linux-Servers-Sudo" "scanuser" "UserPass123!" "sudo" "root" "RootPass456!" "/usr/bin"
```

Expected Output:

```
Credential created successfully. ID: 87654321-4321-4321-4321-210987654321
```

### Understanding the command:

* Escalation Method: "sudo" - Uses sudo for privilege elevation
* Escalation Account: "root" - Target account for privilege escalation
* Escalation Password: "RootPass456!" - Password for the escalation account
* Binary Directory: "/usr/bin" - Location of sudo binary

### 3. List All Credentials

Command to run:

```
python main.py list_credentials
```

Expected Output:

```
Registered credentials:

- Linux-Servers-Basic | UUID: 12345678-1234-1234-1234-123456789abc | Type: SSH | User: scanuser | Escalation: Nothing
- Linux-Servers-Sudo | UUID: 87654321-4321-4321-4321-210987654321 | Type: SSH | User: scanuser | Escalation: sudo
```

### Understanding the command:

* Credential Name: Human-readable identifier
* UUID: Unique identifier used by Tenable.io
* Type: Credential type (SSH, Windows, etc.)
* User: Associated username
* Escalation: Privilege escalation method

### 4. Update Credential Password

Command to run:

```
python main.py edit_credential "12345678-1234-1234-1234-123456789abc" "" "" "NuevoPasswordSeguro2024!"
```
Expected Output:

```
Credential updated successfully.
```

### Understanding the command:

* UUID: "12345678-1234-1234-1234-123456789abc" - Credential identifier
* Empty fields: "" - Indicates no change to name or username
* New Password: "NuevoPasswordSeguro2024!" - Updated password

### 5. Delete a Credential

Command to run:

```
python main.py delete_credential "12345678-1234-1234-1234-123456789abc"
```

Expected Output:

```
Credential deleted successfully.
```

### 6. Check Available Credential Types

Command to run:

```
python main.py credential_ids
```
Expected Output:

```
Available credential types (valid IDs):
- SSH  (Visible name: SSH)
- Windows  (Visible name: Windows)
- Oracle  (Visible name: Oracle Database)
- SNMP  (Visible name: SNMP)
- HTTP  (Visible name: HTTP Header)
```

### 7. View SSH Credential Configuration

Command to run:

```
python main.py credential_config "SSH"
```
Expected Output:

```
Expected configuration for type 'SSH':

- username (Username) → Required | Values: Free text
- password (Password) → Optional | Values: Free text
- private_key (Private Key) → Optional | Values: Free text
- elevate_privileges_with (Privilege Escalation) → Optional | Values: ['Nothing', 'sudo', 'su', 'su+sudo', 'dzdo', 'pbrun']
- escalation_account (Privilege Escalation Account) → Optional | Values: Free text
- escalation_password (Privilege Escalation Password) → Optional | Values: Free text
- bin_directory (Privilege Escalation Bin Directory) → Optional | Values: Free text
```
---

## Notes

* **Authentication:** All functions automatically handle authentication using credentials from the .env file.

* **Security:** Credentials are transmitted securely via HTTPS and stored encrypted in Tenable.io.

* **Error Handling:** Includes comprehensive error handling for API failures, invalid inputs, and network issues.

* **Integration:** Credentials can be referenced in scan policies and configurations.

* **Lifecycle Management:** Supports full CRUD (Create, Read, Update, Delete) operations.

* **Compliance:** All operations adhere to Tenable.io API security standards and best practices.