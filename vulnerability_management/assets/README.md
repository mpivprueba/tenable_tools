# Assets Module

The Assets module provides comprehensive functionality for managing, searching, and exporting asset information from Tenable.io. This module simplifies asset inventory management by wrapping Tenable.io API calls into reusable Python functions and CLI commands.

---
## Purpose

This module functions as the central repository for asset management, enabling:

* Centralized Asset Inventory: Comprehensive tracking of all discovered assets

* Asset Categorization: Organization of assets through tagging and classification

* Security Context Enrichment: Correlation of assets with vulnerability data

* Reporting and Export: Generation of asset reports for compliance and analysis

---

## Module Structure

```
assets/
├── __init__.py
├── list_assets.py          # Asset discovery and listing functionality
├── assets_reports.py       # Asset reporting and export capabilities
└── README.md              # This documentation file
```

---

# Files in this module

**list_assets.py** → Queries registered assets in [Tenable.io](https://www.tenable.com/products/vulnerability-management) and securely displays hostnames and IP addresses

**assets_reports.py** → Searches for assets based on filters (e.g., hostname, IP, operating system).

---

## Requirements

This module depends on the following Python libraries (already included in requirements.txt):

requests
python-dotenv

---

## Install them with:

pip install -r requirements.txt

### Environment variables

The module requires API credentials and configuration stored in a .env file at the project root:

ACCESS_KEY=your_access_key

SECRET_KEY=your_secret_key

BASE_URL=https://cloud.tenable.com

---

## Core Functionalities

### 1. Asset Discovery and Listing

**File: list_assets.py**
```
The list_assets.py module safely retrieves and displays asset information:

def list_assets():
    """
    Retrieves assets from Tenable.io and prints formatted hostname and IP information
    Handles various data formats safely and provides consistent output
    """
```

### 2. Asset Reporting

**File: assets_reports.py**
```
The Assets class in assets_reports.py provides comprehensive reporting capabilities:

class Assets:
    def report(self):
        """
        Exports all assets to 'assets_report.csv' with detailed information including:
        - Asset ID
        - Hostname
        - IP Address
        - Associated Tags
        """
    
    def untagged(self):
        """
        Exports assets without any tags to 'untagged_assets.csv'
        Identifies assets requiring categorization for better security management
        """
```

---

# Getting Started

### Step-by-Step: Opening Terminal and Navigating to Your Project

Step 1: Open Command Prompt or PowerShell

* Press Windows + R keys simultaneously

* Type cmd for Command Prompt or powershell for PowerShell

* Press Enter

### Step 2: Navigate to Your Project Directory

You need to navigate to the folder where you downloaded or cloned the Tenable Tools project. Replace the example path with your actual project location:

cd "C:\PATH\TO\YOUR\PROJECT\tenable_tools\vulnerability_management"

Examples of actual paths:

#### If you saved it in Documents:
cd "C:\Users\YourUsername\Documents\tenable_tools\vulnerability_management"

#### If you saved it on Desktop:
cd "C:\Users\YourUsername\Desktop\tenable_tools\vulnerability_management"

#### If you saved it in a different drive:
cd "D:\Projects\tenable_tools\vulnerability_management"


### Step 3: Verify Your Location
After running the cd command, your terminal should show something like:

PS C:\Users\YourUsername\Documents\tenable_tools\vulnerability_management>


### Step 4: Activate Virtual Environment (if created)

..\venv\Scripts\activate


### Step 5: Verify You Can Run Commands

python main.py --help

---

## How to Find Your Correct Project Path

* Open File Explorer and navigate to your project folder

* Click on the address bar at the top of the window

* Copy the full path shown in the address bar

* Use that exact path in the cd command in your terminal

#### Example:

If your address bar shows:
C:\Development\security_tools\tenable_tools\vulnerability_management

Then use:
cd "C:\Development\security_tools\tenable_tools\vulnerability_management"

---

## Runtime Dependencies

Main CLI Interface [main.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/main.py) - Required for terminal execution

API Utilities [api_utils.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/api_utils.py) - Provides authentication headers

Configuration [config.py](https://github.com/mpivprueba/tenable_tools/blob/main/vulnerability_management/config.py) - Contains base URL and API settings

---

## Quick Usage Examples

1. List All Detected Assets

Command to run:

**python main.py assets**

Expected Output in your terminal:

```
server01.company.com              | IP: 192.168.1.10
dc01.domain.local                 | IP: 192.168.1.11
webserver-prod                    | IP: 192.168.1.12, 192.168.1.13
Unnamed                           | IP: 192.168.1.14
db-server                         | IP: 10.0.1.5
```

### Understanding the output:

* Hostname: The name of the device/server (e.g., "server01.company.com")
* IP Address: The network address of the device (e.g., "192.168.1.10")
* Multiple IPs: Some assets may have multiple IP addresses
* "Unnamed": Assets that don't have a hostname assigned

2. Generate Complete Assets Report

Command to run:

**python main.py generate_assets_report**

Expected Output in your terminal:

Assets report exported.

### The generated CSV file will contain:

```
ID,Name,IP,Tags
12345,server01.company.com,192.168.1.10,"production,web-server"
12346,dc01.domain.local,192.168.1.11,"domain-controller,critical"
12347,webserver-prod,192.168.1.12,"production,web-server"
12348,,192.168.1.14,""
12349,db-server,10.0.1.5,"database,production"
```

---

## Notes
* All functions automatically handle authentication using credentials from the .env file.

* Exported reports are saved in the exports/ directory.

* Includes error handling for invalid filters, empty results, or invalid credentials.

* The asset inventory reflects all scanned or imported assets in Tenable.io.